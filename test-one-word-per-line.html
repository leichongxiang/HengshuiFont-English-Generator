<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One Word Per Line Template Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: transform 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
        }
        .preview {
            margin: 20px 0;
            padding: 15px;
            background: #e9ecef;
            border-radius: 6px;
            font-family: monospace;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ One Word Per Line Template Test</h1>
        
        <div class="test-section">
            <h3>Template Features</h3>
            <ul>
                <li>âœ… Each word on a separate line</li>
                <li>âœ… Clear tracing letters in gray</li>
                <li>âœ… Standard 4-line grid system</li>
                <li>âœ… Word information (phonetics, translation)</li>
                <li>âœ… Proper spacing for practice</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>Test Sample Words</h3>
            <div class="preview">
1. hello /he'lou/ [ä½ å¥½]
2. school /sku:l/ [å­¦æ ¡]  
3. family /'fameli/ [å®¶åº­]
4. teacher /'ti:tSer/ [è€å¸ˆ]
5. student /'stju:dent/ [å­¦ç”Ÿ]
            </div>
            <button onclick="generateTestPDF()">Generate Test PDF</button>
            <button onclick="generateLongTestPDF()">Generate Long Test (20 words)</button>
        </div>

        <div id="status"></div>
    </div>

    <script>
        // Test vocabulary data
        const testWords = [
            { id: '001', word: 'hello', phonetic: '/hÉ™ËˆloÊŠ/', translation: 'ä½ å¥½', grade: 'primary1', category: 'æ—¥å¸¸ç”¨è¯­', difficulty: 'easy', frequency: 10, partOfSpeech: 'interjection' },
            { id: '002', word: 'school', phonetic: '/skuËl/', translation: 'å­¦æ ¡', grade: 'primary1', category: 'å­¦ä¹ ç”¨å“', difficulty: 'easy', frequency: 9, partOfSpeech: 'noun' },
            { id: '003', word: 'family', phonetic: '/ËˆfÃ¦mÉ™li/', translation: 'å®¶åº­', grade: 'primary1', category: 'å®¶åº­æˆå‘˜', difficulty: 'easy', frequency: 8, partOfSpeech: 'noun' },
            { id: '004', word: 'teacher', phonetic: '/ËˆtiËtÊƒÉ™r/', translation: 'è€å¸ˆ', grade: 'primary1', category: 'èŒä¸š', difficulty: 'easy', frequency: 9, partOfSpeech: 'noun' },
            { id: '005', word: 'student', phonetic: '/ËˆstjuËdÉ™nt/', translation: 'å­¦ç”Ÿ', grade: 'primary1', category: 'èŒä¸š', difficulty: 'easy', frequency: 9, partOfSpeech: 'noun' }
        ];

        const longTestWords = [
            ...testWords,
            { id: '006', word: 'apple', phonetic: '/ËˆÃ¦pÉ™l/', translation: 'è‹¹æœ', grade: 'primary1', category: 'æ°´æœ', difficulty: 'easy', frequency: 8, partOfSpeech: 'noun' },
            { id: '007', word: 'book', phonetic: '/bÊŠk/', translation: 'ä¹¦', grade: 'primary1', category: 'å­¦ä¹ ç”¨å“', difficulty: 'easy', frequency: 9, partOfSpeech: 'noun' },
            { id: '008', word: 'water', phonetic: '/ËˆwÉ”ËtÉ™r/', translation: 'æ°´', grade: 'primary1', category: 'é¥®æ–™', difficulty: 'easy', frequency: 10, partOfSpeech: 'noun' },
            { id: '009', word: 'friend', phonetic: '/frend/', translation: 'æœ‹å‹', grade: 'primary2', category: 'äººé™…å…³ç³»', difficulty: 'easy', frequency: 8, partOfSpeech: 'noun' },
            { id: '010', word: 'happy', phonetic: '/ËˆhÃ¦pi/', translation: 'å¿«ä¹çš„', grade: 'primary2', category: 'æƒ…æ„Ÿ', difficulty: 'easy', frequency: 8, partOfSpeech: 'adjective' },
            { id: '011', word: 'beautiful', phonetic: '/ËˆbjuËtÉªfÉ™l/', translation: 'ç¾ä¸½çš„', grade: 'primary3', category: 'å½¢å®¹è¯', difficulty: 'medium', frequency: 7, partOfSpeech: 'adjective' },
            { id: '012', word: 'computer', phonetic: '/kÉ™mËˆpjuËtÉ™r/', translation: 'ç”µè„‘', grade: 'primary4', category: 'ç§‘æŠ€', difficulty: 'medium', frequency: 8, partOfSpeech: 'noun' },
            { id: '013', word: 'important', phonetic: '/ÉªmËˆpÉ”ËrtÉ™nt/', translation: 'é‡è¦çš„', grade: 'grade7', category: 'å½¢å®¹è¯', difficulty: 'medium', frequency: 7, partOfSpeech: 'adjective' },
            { id: '014', word: 'understand', phonetic: '/ËŒÊŒndÉ™rËˆstÃ¦nd/', translation: 'ç†è§£', grade: 'grade7', category: 'åŠ¨è¯', difficulty: 'medium', frequency: 7, partOfSpeech: 'verb' },
            { id: '015', word: 'knowledge', phonetic: '/ËˆnÉ‘ËlÉªdÊ’/', translation: 'çŸ¥è¯†', grade: 'grade8', category: 'æŠ½è±¡æ¦‚å¿µ', difficulty: 'hard', frequency: 6, partOfSpeech: 'noun' },
            { id: '016', word: 'environment', phonetic: '/ÉªnËˆvaÉªrÉ™nmÉ™nt/', translation: 'ç¯å¢ƒ', grade: 'grade8', category: 'ç§‘å­¦', difficulty: 'hard', frequency: 6, partOfSpeech: 'noun' },
            { id: '017', word: 'responsibility', phonetic: '/rÉªËŒspÉ‘ËnsÉ™ËˆbÉªlÉ™ti/', translation: 'è´£ä»»', grade: 'grade9', category: 'æŠ½è±¡æ¦‚å¿µ', difficulty: 'hard', frequency: 5, partOfSpeech: 'noun' },
            { id: '018', word: 'communication', phonetic: '/kÉ™ËŒmjuËnÉªËˆkeÉªÊƒÉ™n/', translation: 'äº¤æµ', grade: 'grade9', category: 'æŠ½è±¡æ¦‚å¿µ', difficulty: 'hard', frequency: 5, partOfSpeech: 'noun' },
            { id: '019', word: 'opportunity', phonetic: '/ËŒÉ‘ËpÉ™rËˆtuËnÉ™ti/', translation: 'æœºä¼š', grade: 'grade9', category: 'æŠ½è±¡æ¦‚å¿µ', difficulty: 'hard', frequency: 5, partOfSpeech: 'noun' },
            { id: '020', word: 'achievement', phonetic: '/É™ËˆtÊƒiËvmÉ™nt/', translation: 'æˆå°±', grade: 'grade9', category: 'æŠ½è±¡æ¦‚å¿µ', difficulty: 'hard', frequency: 5, partOfSpeech: 'noun' }
        ];

        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function safeRenderText(doc, text, x, y, options) {
            try {
                const cleanText = text
                    .replace(/[É™]/g, 'e').replace(/[Éª]/g, 'i').replace(/[ÊŠ]/g, 'u')
                    .replace(/[É”]/g, 'o').replace(/[Ã¦]/g, 'a').replace(/[ÊŒ]/g, 'A')
                    .replace(/[Î¸Ã°]/g, 'th').replace(/[Êƒ]/g, 'sh').replace(/[Ê’]/g, 'zh')
                    .replace(/[Å‹]/g, 'ng').replace(/[ËˆËŒ]/g, "'")
                    .replace(/[^\x00-\x7F]/g, '?');
                
                if (options) {
                    doc.text(cleanText, x, y, options);
                } else {
                    doc.text(cleanText, x, y);
                }
            } catch (error) {
                console.warn('Text rendering error:', error);
                const fallbackText = text.replace(/[^\x00-\x7F]/g, '?');
                doc.text(fallbackText, x, y, options);
            }
        }

        function generateOneWordPerLinePDF(words, title) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('portrait', 'mm', 'a4');
            
            const pageWidth = 210;
            const pageHeight = 297;
            const margin = 15;
            const contentWidth = pageWidth - 2 * margin;
            
            let currentPage = 1;
            let currentY = 40;
            let wordIndex = 0;
            
            // Header function
            function drawHeader(pageNum) {
                doc.setFontSize(16);
                doc.setFont('helvetica', 'bold');
                safeRenderText(doc, title, pageWidth / 2, 15, { align: 'center' });
                
                doc.setFontSize(10);
                doc.setFont('helvetica', 'normal');
                safeRenderText(doc, 'Name: _______________', margin, 25);
                safeRenderText(doc, 'Date: ___________', margin + 80, 25);
                safeRenderText(doc, `Page ${pageNum}`, pageWidth - margin - 20, 25);
            }
            
            // Word practice line function
            function drawWordPracticeLine(word, x, y) {
                const infoWidth = 55;
                const gridWidth = contentWidth - infoWidth - 5;
                const lineHeight = 15;
                
                // Word info
                doc.setFontSize(14);
                doc.setFont('helvetica', 'bold');
                safeRenderText(doc, word.word, x, y + 10);
                
                // Phonetics
                doc.setFontSize(10);
                doc.setFont('helvetica', 'normal');
                safeRenderText(doc, word.phonetic, x, y + 18);
                
                // Grid
                const gridX = x + infoWidth;
                
                // Four lines
                doc.setLineWidth(0.4);
                doc.setDrawColor(0, 0, 0);
                doc.line(gridX, y, gridX + gridWidth, y);
                doc.line(gridX, y + lineHeight, gridX + gridWidth, y + lineHeight);
                
                doc.setLineDashPattern([2, 1], 0);
                doc.setDrawColor(100, 100, 100);
                doc.line(gridX, y + lineHeight / 3, gridX + gridWidth, y + lineHeight / 3);
                doc.line(gridX, y + 2 * lineHeight / 3, gridX + gridWidth, y + 2 * lineHeight / 3);
                doc.setLineDashPattern([], 0);
                
                // Vertical lines
                doc.setDrawColor(220, 220, 220);
                doc.setLineWidth(0.2);
                const letterWidth = Math.min(12, gridWidth / (word.word.length + 1));
                for (let i = 1; i <= word.word.length; i++) {
                    const lineX = gridX + i * letterWidth;
                    if (lineX < gridX + gridWidth) {
                        doc.line(lineX, y, lineX, y + lineHeight);
                    }
                }
                
                // Tracing letters
                doc.setFontSize(13);
                doc.setFont('helvetica', 'normal');
                doc.setTextColor(160, 160, 160);
                
                let letterX = gridX + letterWidth / 2;
                for (const letter of word.word) {
                    if (letterX < gridX + gridWidth - 5) {
                        safeRenderText(doc, letter, letterX, y + 10, { align: 'center' });
                        letterX += letterWidth;
                    }
                }
                
                doc.setTextColor(0, 0, 0);
                doc.setDrawColor(0, 0, 0);
                
                return y + 25;
            }
            
            drawHeader(currentPage);
            
            // Instructions
            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            safeRenderText(doc, 'Instructions: Trace over the gray letters, then practice writing the word in the remaining space.', margin, currentY);
            currentY += 15;
            
            // Generate content
            while (wordIndex < words.length) {
                const word = words[wordIndex];
                
                if (currentY + 25 > pageHeight - 20) {
                    doc.addPage();
                    currentPage++;
                    drawHeader(currentPage);
                    currentY = 40;
                }
                
                currentY = drawWordPracticeLine(word, margin, currentY);
                wordIndex++;
            }
            
            // Footer
            const totalPages = doc.getNumberOfPages();
            for (let i = 1; i <= totalPages; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.setFont('helvetica', 'normal');
                safeRenderText(
                    doc,
                    `One Word Per Line Practice Template | ${words.length} words | Page ${i}/${totalPages}`,
                    pageWidth / 2,
                    pageHeight - 10,
                    { align: 'center' }
                );
            }
            
            return doc;
        }

        function generateTestPDF() {
            showStatus('Generating test PDF with 5 words...', 'info');
            try {
                const doc = generateOneWordPerLinePDF(testWords, 'One Word Per Line Test Template');
                doc.save('test_one_word_per_line.pdf');
                showStatus('âœ… Test PDF generated successfully! Check your downloads.', 'success');
            } catch (error) {
                showStatus(`âŒ Error generating PDF: ${error.message}`, 'error');
            }
        }

        function generateLongTestPDF() {
            showStatus('Generating long test PDF with 20 words...', 'info');
            try {
                const doc = generateOneWordPerLinePDF(longTestWords, 'Extended One Word Per Line Template');
                doc.save('test_one_word_per_line_extended.pdf');
                showStatus('âœ… Extended test PDF generated successfully! Check your downloads.', 'success');
            } catch (error) {
                showStatus(`âŒ Error generating PDF: ${error.message}`, 'error');
            }
        }

        // Auto-test on load
        window.addEventListener('load', () => {
            showStatus('ğŸš€ One Word Per Line Template Tester loaded. Click buttons to generate test PDFs.', 'info');
        });
    </script>
</body>
</html>
